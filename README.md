# Kaguya2

Kaguya2 is an implementation of Brainf\*\*k by Rust.

This implementation consits of following elements,

- Tiny parser
- Tiny compiler
- Tiny virtual stack machine

## Build

```
$ cargo build --release
```

## Usage

```
$ ./target/release/kaguya2 example/helloworkd.bf
```

## Technical components

### Parser

The parser parses a BF script one charactor at a time. Errors can be raised by the parser if the script contains invalid corresponding of `[` and `]` or invalid charactors.

Only the root node and `while` nodes have children.

### Virtual machine

Kaguya2 VM has a two stacks (left\_stack, right\_stack) and has following 9 instructions,

- `forward`: Forward stack, if right\_stack is empty then push 0 to left\_stack else move top of right\_stack to left\_stack.
- `backward`: Backward stack, top data of left\_stack is poped and pushed to right\_stack.
- `increment`: Increment top of left\_stack.
- `decrement`: Decrement top of left\_stack.
- `output`: Output top of left\_stack to standard I/O.
- `input`: Input a value from standard I/O and push it to left\_stack.
- `branch_ifzero N`: Jump to an instruction at `PC - N` if top of left\_stack is 0.
- `branch_unlesszero N`: Jump to an instruction at `PC - N` unless top of left\_stack is 0.
- `leave`: Exit

### Compiler

Kaguya2 compiler compiles an AST generated by the parser to an instruction sequence for Kaguya2 VM.

## Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/mozamimy/kaguya.

## License

The gem is available as open source under the terms of the [MIT License](http://opensource.org/licenses/MIT).
